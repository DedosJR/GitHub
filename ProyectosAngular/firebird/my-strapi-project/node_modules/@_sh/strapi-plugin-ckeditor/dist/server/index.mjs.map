{"version":3,"file":"index.mjs","sources":["../../server/src/utils/pluginId.js","../../server/src/register.js","../../server/src/controllers/config.js","../../server/src/controllers/index.js","../../server/src/routes/index.js","../../server/src/services/config.js","../../server/src/services/index.js","../../server/src/index.js"],"sourcesContent":["'use strict';\n\nconst pluginPkg = require('../../../package.json');\n\nmodule.exports =\n  pluginPkg.strapi.name ||\n  pluginPkg.name.replace(/^(@_sh\\/strapi-)plugin-/i, '');\n","'use strict';\n\nconst pluginId = require('./utils/pluginId');\n\nmodule.exports = ({ strapi }) => {\n  strapi.customFields.register({\n    name: 'CKEditor',\n    plugin: pluginId,\n    type: 'richtext',\n  });\n};\n","'use strict';\n\nconst pluginId = require('../utils/pluginId');\n\nmodule.exports = {\n  getConfig: async (ctx) => {\n    const { responsiveDimensions = false } = await strapi\n      .plugin('upload')\n      .service('upload')\n      .getSettings();\n\n    const config =\n      (await strapi.plugin(pluginId).service('config').getConfig()) +\n      `\\nglobalThis.SH_CKE_UPLOAD_ADAPTER_IS_RESPONSIVE = ${responsiveDimensions}`;\n\n    ctx.type = 'application/javascript';\n    ctx.send(config);\n  },\n};\n","'use strict';\n\nconst config = require('./config');\n\nmodule.exports = {\n  config,\n};\n","module.exports = {\n  config: {\n    type: 'admin',\n    routes: [\n      {\n        method: 'GET',\n        path: '/config/ckeditor',\n        handler: 'config.getConfig',\n        config: {\n          auth: false,\n        },\n      },\n    ],\n  },\n};\n","'use strict';\n\nconst fs = require('fs');\n\nmodule.exports = ({ strapi }) => {\n  const readConfigFile = () => {\n    const appDir = process.cwd();\n    const isTSProject = fs.existsSync(`${appDir}/dist`);\n    const envName = process.env.NODE_ENV;\n\n    const cfgDir = isTSProject ? `${appDir}/dist/config` : `${appDir}/config`;\n    const cfgFileName = 'ckeditor.js';\n\n    const envFilePath = `${cfgDir}/env/${envName}/${cfgFileName}`;\n    const baseFilePath = `${cfgDir}/${cfgFileName}`;\n\n    if (fs.existsSync(envFilePath)) {\n      return fs.readFileSync(envFilePath, 'utf8');\n    } else if (fs.existsSync(baseFilePath)) {\n      return fs.readFileSync(baseFilePath, 'utf8');\n    } else {\n      return null;\n    }\n  };\n\n  const trimConfig = (str) => {\n    for (const func of ['const CKEConfig', 'function CKEConfig']) {\n      const idx = str.indexOf(func);\n      if (idx >= 0) {\n        return str.substring(idx) + `\\nglobalThis.SH_CKE_CONFIG = CKEConfig()`;\n      }\n    }\n  };\n\n  return {\n    getConfig() {\n      const configFileContent = readConfigFile();\n      const config = configFileContent && trimConfig(configFileContent);\n\n      return config || `globalThis.SH_CKE_CONFIG = null`;\n    },\n  };\n};\n","'use strict';\n\nconst config = require('./config');\n\nmodule.exports = {\n  config,\n};\n","'use strict';\n\nconst register = require('./register');\nconst controllers = require('./controllers');\nconst routes = require('./routes');\nconst services = require('./services');\n\nmodule.exports = {\n  register,\n  controllers,\n  routes,\n  services\n};\n"],"names":["pluginId","require$$0","register","strapi","config","controllers","routes","services","require$$1","require$$2","require$$3"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAEA,MAAM,YAAY;IAElBA,aACE,UAAU,OAAO;ACHnB,MAAMA,aAAWC;AAEjB,IAAAC,aAAiB,CAAC,EAAE,QAAAC,cAAa;AAC/B,EAAAA,QAAO,aAAa,SAAS;AAAA,IAC3B,MAAM;AAAA,IACN,QAAQH;AAAAA,IACR,MAAM;AAAA,EACV,CAAG;AACH;ACRA,MAAM,WAAWC;AAEjB,IAAAG,WAAiB;AAAA,EACf,WAAW,OAAO,QAAQ;AACxB,UAAM,EAAE,uBAAuB,MAAO,IAAG,MAAM,OAC5C,OAAO,QAAQ,EACf,QAAQ,QAAQ,EAChB;AAEH,UAAMA,UACH,MAAM,OAAO,OAAO,QAAQ,EAAE,QAAQ,QAAQ,EAAE,UAAW,IAC5D;AAAA,mDAAsD,oBAAoB;AAE5E,QAAI,OAAO;AACX,QAAI,KAAKA,OAAM;AAAA,EAChB;AACH;AChBA,MAAMA,WAASH;AAEf,IAAAI,gBAAiB;AAAA,EACjB,QAAED;AACF;ACNA,IAAAE,WAAiB;AAAA,EACf,QAAQ;AAAA,IACN,MAAM;AAAA,IACN,QAAQ;AAAA,MACN;AAAA,QACE,QAAQ;AAAA,QACR,MAAM;AAAA,QACN,SAAS;AAAA,QACT,QAAQ;AAAA,UACN,MAAM;AAAA,QACP;AAAA,MACF;AAAA,IACF;AAAA,EACF;AACH;ACZA,MAAM,KAAKL;AAEX,IAAAG,WAAiB,CAAC,EAAE,QAAAD,cAAa;AAC/B,QAAM,iBAAiB,MAAM;AAC3B,UAAM,SAAS,QAAQ;AACvB,UAAM,cAAc,GAAG,WAAW,GAAG,MAAM,OAAO;AAClD,UAAM,UAAU,QAAQ,IAAI;AAE5B,UAAM,SAAS,cAAc,GAAG,MAAM,iBAAiB,GAAG,MAAM;AAChE,UAAM,cAAc;AAEpB,UAAM,cAAc,GAAG,MAAM,QAAQ,OAAO,IAAI,WAAW;AAC3D,UAAM,eAAe,GAAG,MAAM,IAAI,WAAW;AAE7C,QAAI,GAAG,WAAW,WAAW,GAAG;AAC9B,aAAO,GAAG,aAAa,aAAa,MAAM;AAAA,IAC3C,WAAU,GAAG,WAAW,YAAY,GAAG;AACtC,aAAO,GAAG,aAAa,cAAc,MAAM;AAAA,IACjD,OAAW;AACL,aAAO;AAAA,IACR;AAAA,EACL;AAEE,QAAM,aAAa,CAAC,QAAQ;AAC1B,eAAW,QAAQ,CAAC,mBAAmB,oBAAoB,GAAG;AAC5D,YAAM,MAAM,IAAI,QAAQ,IAAI;AAC5B,UAAI,OAAO,GAAG;AACZ,eAAO,IAAI,UAAU,GAAG,IAAI;AAAA;AAAA,MAC7B;AAAA,IACF;AAAA,EACL;AAEE,SAAO;AAAA,IACL,YAAY;AACV,YAAM,oBAAoB;AAC1B,YAAMC,UAAS,qBAAqB,WAAW,iBAAiB;AAEhE,aAAOA,WAAU;AAAA,IAClB;AAAA,EACL;AACA;ACxCA,MAAM,SAASH;AAEf,IAAAM,aAAiB;AAAA,EACf;AACF;ACJA,MAAM,WAAWN;AACjB,MAAM,cAAcO;AACpB,MAAM,SAASC;AACf,MAAM,WAAWC;AAEjB,IAAA,MAAiB;AAAA,EACf;AAAA,EACA;AAAA,EACA;AAAA,EACA;AACF;;"}